package BookRules

//list any import classes here.



//declare any global variables here

import rs.sbnz.book_recommender.model.Book;
import rs.sbnz.book_recommender.model.facts.BookLengthTypeData;
import rs.sbnz.book_recommender.model.Score;
import java.util.Set;


rule "Long length rule"
    agenda-group "Level1"
    no-loop
    when
    	$d: BookLengthTypeData(min : minLength,max : maxLength) and
        $b: Book(pageNum > min, pageNum < max, title : title, avgGrade: getAvgGrade(), brPregleda: brPregleda, score: score)
        avgBookGrade(score, $bookGrade;)
        eval($bookGrade != 0)
    then
        //System.out.println(title);
        //System.out.println(avgGrade);
        System.out.println("Zabo start");
        modify($d){increaseGrade(($bookGrade / score.size()) * brPregleda)}
end

query avgBookGrade(Set scoreList, Double $num)
    $num := Double(intValue >= 0)
    from accumulate(Score($s: this, value: value) from scoreList,
    	sum(value))
end